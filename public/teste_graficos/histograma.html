<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Histograma</title>
</head>
<body>
    <h1 style="text-align: center;">Gráfico Histograma</h1>
    <div id="container"></div>
<script type="module">

import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";

// Declare the chart dimensions and margins.
const width = 960;
const height = 500;
const marginTop = 20;
const marginRight = 20;
const marginBottom = 30;
const marginLeft = 40;

// Assume `data` is your numeric array.
// Example:
const data = [
        9.36801919963267,
        11.3684807429961,
        9.76513901271954,
        10.2406367939385,
        8.33182107106923,
        10.5695055789114,
        8.97711074372543,
        10.2619280659742,
        9.10349439007723,
        9.86693233606935,
        9.83616178965101,
        9.72222745469918,
        10.0017487927668,
        10.9449362630317,
        10.813359736689,
        9.99620959519288,
        10.279254864616,
        9.84210206944477,
        8.85566330391115,
        9.93650987119442,
        9.62971225896196,
        9.82844014594384,
        11.1182658736051,
        10.6707107174383,
        10.2204469403465,
        10.2468360242043,
        10.1777041189706,
        10.7923997302596,
        10.1479844686337,
        10.5192731114233,
        9.44450249566154,
        9.73441087527448,
        11.8045416469359,
        11.946589640779,
        10.7025893971791,
        9.38136999535078,
        9.85686179814874,
        9.98100136630625,
        9.6027045081112,
        11.3917488480843,
        8.16440949944546,
        10.4370335778017,
        11.3894837371406,
        8.84572790388199,
        9.11645780107156,
        10.4237842430637,
        11.1623569169693,
        10.894529612172,
        8.49734839411957,
        11.0313912413203,
        9.31276467962992,
        9.68090679390824,
        9.36090593318425,
        10.8931940416604,
        9.72997943540692,
        9.9569705674683,
        10.4485971847474,
        9.76170895502196,
        8.80888677985546,
        11.5289861318272,
        9.81541874085976,
        9.69997802257932,
        11.0712474830029,
        8.37672119136011,
        9.48746974121436,
        7.62589890775157,
        9.01345904870835,
        10.2976020975636,
        9.13780163208904,
        9.29191384229228,
        9.12702783847351,
        10.8577341446733,
        7.32568356861797,
        9.38899020615768,
        9.67166181164913,
        9.17452322384665,
        8.63687963497678,
        10.4704178545518,
        9.82830919640435,
        10.322364269453,
        10.0027645050963,
        10.1056657447933,
        12.2544841883815,
        12.0947070068396,
        10.7757700836285,
        10.0944172161446,
        10.4317277900206,
        10.3367942023032,
        12.0564251100356,
        9.7948194467351,
        10.309901524954,
        9.20267643407913,
        10.5606732489722,
        11.4371750881419,
        9.69751120990992,
        10.4841139775085,
        10.2370383650351,
        9.4829827776551,
        10.7744074144448,
        8.64250561321286,
        10.6219016811876,
        10.4906645156941,
        8.67182934670658,
        10.9718530447923,
        9.1807545561927,
        7.48551102028966,
        11.0299416260453,
        11.0283122617966,
        9.26985650433198,
        11.1525978993439,
        9.3267747917268,
        11.3338863161951,
        10.2606847920982,
        7.72268656648238,
        10.4448171539997,
        10.6260596132991,
        9.57322580327268,
        10.4418561200104,
        7.5995319970421,
        8.4725910747518,
        8.80615874012856,
        10.7022435220629,
        9.38382214830546,
        10.6693890744122,
        9.40985375557322,
        8.8734141522343,
        10.6702077696331,
        10.3288659192147,
        10.4220243149756,
        9.54184671689321,
        10.6489464584652,
        11.3160733054679,
        9.92063682890879,
        8.5869792894683,
        10.7023033815137,
        10.5829634886513,
        8.78731163808375,
        9.54033139845369,
        9.88284582560635,
        9.82273393736993,
        9.87106882150848,
        7.25424826706124,
        9.54136907864755,
        9.16313620004681,
        8.27063198056972,
        9.46215910466313,
        10.2845046351115,
        8.80659540053253,
        9.39607132434031,
        9.89516779753685,
        9.85351756499372,
        10.0265710148759,
        7.37489898430379,
        10.6963850021381,
        8.86377236236721,
        11.153485949831,
        11.1995769362645,
        10.5090724624401,
        8.70364735318979,
        10.0170050675355,
        9.82141230877925,
        8.28318766263961,
        10.6691701094962,
        10.6688154399234,
        11.3650257540407,
        9.81395987246103,
        8.12945541044197,
        7.98347749530654,
        12.316096695106,
        10.2588198798041,
        10.8641624362068,
        10.1292507329102,
        8.1297737008415,
        10.8206114750555,
        10.3631889022187,
        11.3833025057228,
        11.0898335148454,
        9.17391731082674,
        9.16586040113834,
        9.53630921298483,
        8.24923579221813,
        10.5204258910122,
        9.47726945922805,
        8.69693673140051,
        10.1615861747378,
        9.77552500627512,
        9.85560739600138,
        9.64525800141526,
        9.54090209378573,
        8.12789503806809,
        10.5647674744225,
        12.2860299935079,
        7.33746142293758,
        10.0676865956819,
        9.63906872647146,
        9.87611363631839,
        10.8376845815111,
        8.88364822521554,
        10.9905058401128,
        9.50260068703503,
        8.64907663481434,
        8.87559077929798,
        11.9295815168491,
        10.7599692140444,
        11.2003135929665,
        10.7585488023194,
        11.2997886444907,
        8.84396306908362,
        10.3461931881361,
        7.98569073519552,
        9.48211845382785,
        11.3410995692773,
        10.3397795414269,
        11.1704146338518,
        10.7241953776017,
        11.3778095819243,
        9.07999006633859,
        10.721922893713,
        9.73855036337524,
        10.48863319389,
        8.06988208829984,
        9.36610358141827,
        8.12079571097387,
        12.5313153899395,
        11.1992631656809,
        9.39050955041204,
        11.295465922046,
        9.60999197069084,
        10.8737558097806,
        11.5337100226312,
        10.2425724061656,
        8.74576583950717,
        10.2245804182895,
        10.8266224930669,
        9.17408318033435,
        8.07666310665646,
        10.3324808106325,
        8.77303435345159,
        9.98294396670982,
        10.2524117445572,
        9.42342779140847,
        9.33666623484627,
        9.6823580880263,
        11.176651963882,
        10.717168594755,
        9.2369254881851,
        9.92598114746552,
        10.0005872302917,
        9.52692397162214,
        8.5114774103542,
        9.54144573207856,
        9.78234316905065,
        9.93349865457959,
        10.4303784682114,
        10.4283269576307,
        9.12284076187208,
        11.0371941398549,
        11.4550168861599,
        11.5550680039591,
        10.5150937462116,
        8.95126364396269,
        8.28149467181729,
        10.6967012015203,
        10.0285437445603,
        9.58869750336529,
        11.6372532786733,
        7.46933995599584,
        7.75894735477995,
        9.88050665549168,
        10.8087044144109,
        10.2915278046189,
        9.83434516553564,
        9.15800521278672,
        10.0889233208578,
        11.7230268843464,
        10.6018985705163,
        10.7055449450431,
        10.4190279194459,
        9.46452023815786,
        9.67017624161889,
        10.1170276294214,
        9.54374680850045,
        8.46115042232389,
        8.78857354705308,
        10.4719722416902,
        9.69548108016142,
        12.3968831490588,
        10.0963117708939,
        10.213807823863,
        10.9504615943447,
        10.2217558086629,
        9.76642920092556,
        10.9075626073974,
        12.0645244451428,
        9.44207903975842,
        10.4808399915072,
        10.4946444371062,
        9.26874116390574,
        11.2834081106456,
        9.50469027763453
      ]

// Bin the data.
const bins = d3.bin()
    .thresholds(30) // Número de bins (pode ser ajustado) // vai ser ajustado para n/10, e o resultado for menor que 10 vira 10
    .value(d => d)  // Acessa diretamente o valor do vetor
    (data);

// Normalize the frequencies (convert to percentages).
const totalCount = data.length;
const normalizedBins = bins.map(bin => ({
  ...bin,
  normalizedLength: bin.length / totalCount // Frequência normalizada
}));

// Declare the x (horizontal position) scale.
const x = d3.scaleLinear()
    .domain([bins[0].x0, bins[bins.length - 1].x1])
    .range([marginLeft, width - marginRight]);

// Declare the y (vertical position) scale.
const y = d3.scaleLinear()
    .domain([0, d3.max(normalizedBins, d => d.normalizedLength)])
    .range([height - marginBottom, marginTop]);

// Create the SVG container.
const svg = d3.create("svg")
    .attr("width", width)
    .attr("height", height)
    .attr("viewBox", [0, 0, width, height])
    .attr("style", "max-width: 100%; height: auto;");

// Add a rect for each bin.
svg.append("g")
    .attr("fill", "steelblue")
  .selectAll("rect")
  .data(normalizedBins)
  .join("rect")
    .attr("x", d => x(d.x0) + 1)
    .attr("width", d => x(d.x1) - x(d.x0) - 1)
    .attr("y", d => y(d.normalizedLength))
    .attr("height", d => y(0) - y(d.normalizedLength));

// Add the x-axis and label.
svg.append("g")
    .attr("transform", `translate(0,${height - marginBottom})`)
    .call(d3.axisBottom(x).ticks(width / 80).tickSizeOuter(0))
    .call(g => g.append("text")
        .attr("x", width)
        .attr("y", marginBottom - 4)
        .attr("fill", "currentColor")
        .attr("text-anchor", "end")
        .text("Value →")); // Etiqueta do eixo x

// Add the y-axis and label, and remove the domain line.
svg.append("g")
    .attr("transform", `translate(${marginLeft},0)`)
    .call(d3.axisLeft(y).ticks(height / 40).tickFormat(d3.format(".0%"))) // Exibe como %
    .call(g => g.select(".domain").remove())
    .call(g => g.append("text")
        .attr("x", -marginLeft)
        .attr("y", 10)
        .attr("fill", "currentColor")
        .attr("text-anchor", "start")
        .text("↑ Frequency (proportion)")); // Etiqueta do eixo y

// Append the SVG element to the DOM.
document.body.append(svg.node());


</script>
</body>
</html>